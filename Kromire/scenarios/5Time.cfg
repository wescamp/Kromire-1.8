
#SCENARIO 5: You find that the elementals have been stirred to action.

[scenario]
    #textdomain wesnoth-Kromire
    name= _ "Valemoi"
    id=CK_Time
    turns=38
    map_data="{~add-ons/Kromire/maps/5Time.map}"
    next_scenario=CK_meetings
    {DEFAULT_MUSIC_PLAYLIST}

    {MORNING}
    {AFTERNOON}
    {DUSK}
    {FIRST_WATCH}
    {SECOND_WATCH}
    {DAWN}

    {CC_DEATHS}

    [side]
        side=1
        controller=human
        team_name=Kromire
        {GOLD 300 300 250}
        village_gold=1
        colour=black
        recruit=EOM_Fledgeling,EOM_Thin_Blood,Vampire Bat,EOM_Bloodborn,EOM_Blood_Apprentice
        type=EOM_Noble
        id=Kromire
        name= _ "Kromire"
        canrecruit=yes
    [/side]
    [side]
        side=2
        controller=ai
        team_name=Warg
        recruit=EOM_Warrior_Warg,EOM_Stalker,EOM_Dire_Wolf
        village_gold=1

        {GOLD 125 175 200}
        facing=sw
        type=EOM_Pack_Leader
        id=Wleader
        name= _ "Verwl"
        canrecruit=yes
        [ai]
            villages_per_scout=0
        [/ai]
    [/side]

    [side]
        side=3
        controller=ai
        team_name=Warg
        recruit=EOM_Warrior_Wolf,EOM_Stalker,EOM_Fire_Sprite
        {GOLD 100 150 200}
        village_gold=1
        facing=nw
        type=EOM_Pack_Leader
        id=Wleader2
        name= _ "Crwa"
        canrecruit=yes
        [ai]
            villages_per_scout=0
        [/ai]
    [/side]
    [side]
        side=4
        controller=ai
        team_name=Warg
        recruit=EOM_Air,EOM_Vine_Beast,EOM_Earth,EOM_Water
        {GOLD 125 150 175}
        village_gold=1

        type=EOM_Djinn
        id=Eleader
        name= _ "Visine"
        canrecruit=yes
        [ai]
            villages_per_scout=0
            recruitment_ignore_bad_movement=yes
        [/ai]
    [/side]
    [side]
        side=5
        controller=ai
        team_name=Warg
        colour=brown
        recruit=EOM_Air,EOM_Fire,EOM_Earth
        {GOLD 75 100 125}
        village_gold=1

        type=EOM_Rock_Golem
        id=Eleader2
        name= _ "Obsidian"
        canrecruit=yes
        [ai]
            villages_per_scout=0
            recruitment_ignore_bad_movement=yes
        [/ai]
    [/side]
    [side]
        side=6
        controller=ai
        team_name=Kromire
        colour=red
        recruit=EOM_Fledgeling,EOM_Thin_Blood,EOM_Gargoyle,EOM_Bloodborn,EOM_Blood_Apprentice
        {GOLD 75 125 225}
        village_gold=1
        facing=nw
        type=EOM_Sangel
        id=Vleader
        name= _ "Count Valemoi"
        canrecruit=yes
        [ai]
            villages_per_scout=0
            passive_leader=yes
        [/ai]
    [/side]

    [story]
        [part]
            story= _ "After finishing off the last defiant remnants, I led my army up into the mountains, towards the realm of Valemoi."
        [/part]
        [part]
            story= _ "I was eager to quickly conquer Valemoi, but we found that Valemoi was having trouble of his own already."
        [/part]
    [/story]

    [event]
        name=prestart

        [recall]
            id=Igor
        [/recall]

        {SET_FACING (id=Kromire) se}
        {SET_FACING (id=Igor) se}
    [/event]

    [event]
        name=start
        [message]
            id=Vleader
            message= _ "I can smell bad blood near..."
        [/message]
        [message]
            id=Kromire
            message= _ "You do not appear to be in a good position to insult, Lord Valemoi."
        [/message]
        [message]
            id=Vleader
            message= _ "Kromire, this had better not be your doing. Your recent conquest has swelled your head, but your youthful fancies pale before the power I have accumulated over the years."
        [/message]
        [message]
            id=Wleader
            message= _ "We would never ally with your kind! The idea is despicable."
        [/message]
        [message]
            id=Eleader
            message= _ "...d...i....e..."
        [/message]
        [message]
            id=Kromire
            message= _ "This is odd. Elementals do not form armies, nor do they hunt out vampires."
        [/message]
        [message]
            id=Wleader2
            message= _ "In the past no, but elements are the unspoken guardians of the world. They are more attuned than most, and they felt the threat posed by those who would leech the life from all living creatures. They banded together to eliminate that threat and when we saw them on the march, we could not deny their noble cause. We came to support them, and cast down you lords of darkness!"
        [/message]
        [message]
            id=Kromire
            message= _ "Ha! You know nothing of our kind. Regardless of what he does to his serfs, Valemoi is not a threat to the world. We live alone in our castles, lording over our peasants and biding our time. We have no dreams of world conquest."
        [/message]
        [message]
            id=Wleader2
            message= _ "Normally, no, but recently there has been much trouble stirring in your lands. We know that you have been displaced by the Celestials, and you may turn to Valemoi for aid. It is that unholy alliance that we are here to stop!"
        [/message]
        [message]
            id=Kromire
            message= _ "Then you are misinformed of our kind, worm. We do not make alliances so easily. Valemoi, I do not have to fight these creatures, I could merely head back the way I came. You cannot run, for doing so would lose you your lands and your serfs, the loss of which would mean ruin to you."
        [/message]
        [message]
            id=Vleader
            message= _ "Get to the point."
        [/message]
        [message]
            id=Kromire
            message= _ "In exchange for whatever help you can give me defeating the celestials, I will save you from your sure defeat."
        [/message]
        [message]
            id=Vleader
            message= _ "Arrogant pup! I will show you your place some day, mark my words. But I cannot argue your truths. I do see my demise without your help. So be it. If we both survive this day, I will come to your side when you march on your keep."
        [/message]
        [message]
            id=Igor
            message={WHISPER (_ "I would not thrtht him master. Heth will seethk to bethray us.")}
        [/message]
        [unit]
            x,y=26,35
            type=EOM_Fledgeling
            generate_name=yes
            random_traits=yes
            side=6
        [/unit]
        [unit]
            x,y=18,33
            type=EOM_Fledgeling
            generate_name=yes
            random_traits=yes
            side=6
        [/unit]
        [unit]
            x,y=38,25
            type=EOM_Fledgeling
            generate_name=yes
            random_traits=yes
            side=6
        [/unit]
        [unit]
            x,y=40,24
            type=EOM_Fledgeling
            generate_name=yes
            random_traits=yes
            side=6
        [/unit]
        [unit]
            x,y=31,13
            type=EOM_Fledgeling
            generate_name=yes
            random_traits=yes
            side=6
        [/unit]
        [unit]
            x,y=36,22
            type=EOM_Fledgeling
            generate_name=yes
            random_traits=yes
            side=6
        [/unit]
        [unit]
            x,y=34,25
            type=EOM_Fledgeling
            generate_name=yes
            random_traits=yes
            side=6
        [/unit]
        [unit]
            x,y=34,25
            type=EOM_Fledgeling
            generate_name=yes
            random_traits=yes
            side=6
        [/unit]
        [unit]
            x,y=33,14
            type=EOM_Fledgeling
            generate_name=yes
            random_traits=yes
            side=6
        [/unit]
        [unit]
            x,y=42,19
            type=EOM_Fledgeling
            generate_name=yes
            random_traits=yes
            side=6
        [/unit]
        [unit]
            x,y=39,24
            type=EOM_Fledgeling
            generate_name=yes
            random_traits=yes
            side=6
        [/unit]
        [unit]
            x,y=37,26
            type=EOM_Fledgeling
            generate_name=yes
            random_traits=yes
            side=6
        [/unit]
        [unit]
            x,y=27,33
            type=EOM_Fledgeling
            generate_name=yes
            random_traits=yes
            side=6
        [/unit]
        [unit]
            x,y=31,27
            type=EOM_Fledgeling
            generate_name=yes
            random_traits=yes
            side=6
        [/unit]
        [unit]
            x,y=42,21
            type=EOM_Fledgeling
            generate_name=yes
            random_traits=yes
            side=6
        [/unit]
        [unit]
            x,y=15,27
            type=EOM_Fledgeling
            generate_name=yes
            random_traits=yes
            side=6
            facing=nw
        [/unit]
        [unit]
            x,y=15,25
            type=EOM_Fledgeling
            generate_name=yes
            random_traits=yes
            side=6
        [/unit]
        [unit]
            x,y=10,19
            type=EOM_Fledgeling
            generate_name=yes
            random_traits=yes
            side=6
            facing=sw
        [/unit]
        [unit]
            x,y=29,17
            type=EOM_Blood_Apprentice
            generate_name=yes
            random_traits=yes
            side=6
        [/unit]
        [unit]
            x,y=34,23
            type=EOM_Blood_Apprentice
            generate_name=yes
            random_traits=yes
            side=6
        [/unit]
        [unit]
            x,y=18,24
            type=EOM_Blood_Apprentice
            generate_name=yes
            random_traits=yes
            side=6
        [/unit]
        [unit]
            x,y=29,35
            type=EOM_Blood_Hulk
            generate_name=yes
            random_traits=yes
            side=6
        [/unit]
        [unit]
            x,y=33,19
            type=EOM_Blood_Hulk
            generate_name=yes
            random_traits=yes
            side=6
        [/unit]
        [unit]
            x,y=35,16
            type=EOM_Thin_Blood
            generate_name=yes
            random_traits=yes
            side=6
        [/unit]
        [unit]
            x,y=25,29
            type=EOM_Thin_Blood
            generate_name=yes
            random_traits=yes
            side=6
        [/unit]
        [unit]
            x,y=20,22
            type=EOM_Thin_Blood
            generate_name=yes
            random_traits=yes
            side=6
        [/unit]
        [unit]
            x,y=46,23
            type=EOM_Thin_Blood
            generate_name=yes
            random_traits=yes
            side=6
            facing=nw
        [/unit]
        [unit]
            x,y=42,25
            type=EOM_Warrior_Wolf
            generate_name=yes
            random_traits=yes
            side=3
            facing=nw
        [/unit]
        [unit]
            x,y=42,28
            type=EOM_Warrior_Wolf
            generate_name=yes
            random_traits=yes
            side=3
            facing=nw
        [/unit]
        [unit]
            x,y=36,28
            type=EOM_Warrior_Wolf
            generate_name=yes
            random_traits=yes
            side=3
            facing=nw
        [/unit]
        [unit]
            x,y=46,23
            type=EOM_Warrior_Wolf
            generate_name=yes
            random_traits=yes
            side=3
        [/unit]
        [unit]
            x,y=43,12
            type=EOM_Warrior_Wolf
            generate_name=yes
            random_traits=yes
            side=2
            facing=sw
        [/unit]
        [unit]
            x,y=40,7
            type=EOM_Warrior_Wolf
            generate_name=yes
            random_traits=yes
            side=2
            facing=sw
        [/unit]
        [unit]
            x,y=37,38
            type=EOM_Water
            generate_name=yes
            random_traits=yes
            side=4
            facing=nw
        [/unit]
        [unit]
            x,y=29,36
            type=EOM_Water
            generate_name=yes
            random_traits=yes
            side=4
        [/unit]
        [unit]
            x,y=23,40
            type=EOM_Water
            generate_name=yes
            random_traits=yes
            side=4
        [/unit]
        [unit]
            x,y=31,33
            type=EOM_Water
            generate_name=yes
            random_traits=yes
            side=4
        [/unit]
        [unit]
            x,y=27,39
            type=EOM_Vine_Beast
            generate_name=yes
            random_traits=yes
            side=4
        [/unit]
        [unit]
            x,y=34,34
            type=EOM_Vine_Beast
            generate_name=yes
            random_traits=yes
            side=4
            facing=nw
        [/unit]
        [unit]
            x,y=16,40
            type=EOM_Vine_Beast
            generate_name=yes
            random_traits=yes
            side=4
        [/unit]
        [unit]
            x,y=19,41
            type=EOM_Vine_Beast
            generate_name=yes
            random_traits=yes
            side=4
        [/unit]
        [unit]
            x,y=6,21
            type=EOM_Earth
            generate_name=yes
            random_traits=yes
            side=5
        [/unit]
        [unit]
            x,y=3,27
            type=EOM_Earth
            generate_name=yes
            random_traits=yes
            side=5
        [/unit]
        [unit]
            x,y=15,27
            type=EOM_Earth
            generate_name=yes
            random_traits=yes
            side=5
        [/unit]
        [unit]
            x,y=6,27
            type=EOM_Fire
            generate_name=yes
            random_traits=yes
            side=5
        [/unit]
        [unit]
            x,y=15,29
            type=EOM_Air
            generate_name=yes
            random_traits=yes
            side=5
        [/unit]
        [unit]
            x,y=3,22
            type=EOM_Air
            generate_name=yes
            random_traits=yes
            side=5
        [/unit]
        [unit]
            x,y=21,40
            type=EOM_Air
            generate_name=yes
            random_traits=yes
            side=5
        [/unit]
        [unit]
            x,y=14,35
            type=EOM_Air
            generate_name=yes
            random_traits=yes
            side=5
        [/unit]
        [unit]
            x,y=12,25
            type=EOM_Air
            generate_name=yes
            random_traits=yes
            side=5
        [/unit]
        [capture_village]
            side=6
            x,y=25,20
        [/capture_village]
        [capture_village]
            side=6
            x,y=31,13
        [/capture_village]
        [capture_village]
            side=6
            x,y=33,17
        [/capture_village]
        [capture_village]
            side=6
            x,y=35,16
        [/capture_village]
        [capture_village]
            side=6
            x,y=38,17
        [/capture_village]
        [capture_village]
            side=6
            x,y=40,18
        [/capture_village]
        [capture_village]
            side=6
            x,y=42,19
        [/capture_village]
        [capture_village]
            side=6
            x,y=42,21
        [/capture_village]
        [capture_village]
            side=6
            x,y=41,23
        [/capture_village]
        [capture_village]
            side=6
            x,y=39,24
        [/capture_village]
        [capture_village]
            side=6
            x,y=37,26
        [/capture_village]
        [capture_village]
            side=6
            x,y=34,25
        [/capture_village]
        [capture_village]
            side=6
            x,y=31,24
        [/capture_village]
        [capture_village]
            side=6
            x,y=30,21
        [/capture_village]
        [capture_village]
            side=6
            x,y=30,19
        [/capture_village]
        [capture_village]
            side=6
            x,y=22,29
        [/capture_village]
        [capture_village]
            side=6
            x,y=27,30
        [/capture_village]
        [capture_village]
            side=6
            x,y=27,33
        [/capture_village]
        [capture_village]
            side=6
            x,y=22,34
        [/capture_village]
        [capture_village]
            side=6
            x,y=28,34
        [/capture_village]

        {SET_FACING (id=Vleader) se}

        [objectives]
            side=1
            [objective]
                description= _ "Defeat your foes"
                condition=win
            [/objective]
            [objective]
                description= _ "Death of Kromire"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of Valemoi"
                condition=lose
            [/objective]
        [/objectives]
    [/event]

    [event]
        name=start
        {VARIABLE valemoi 0}
    [/event]

    [event]
        name=die
        [filter]
            id=Vleader
        [/filter]
        [if]
            [variable]
                name=valemoi
                equals=0
            [/variable]
            [then]
                {VARIABLE valemoi 1}
                [message]
                    id=Kromire
                    message= _ "His magic would have been an asset to our victory. No bother. We will win without him."
                [/message]
            [/then]
        [/if]
    [/event]

    # Valemoi betrays

    [event]
        name=die
        [filter]
            id=Eleader
        [/filter]
        [if]
            [have_unit]
                id=Wleader2
            [/have_unit]
            [then]
            [/then]
            [else]
                [modify_side]
                    side=6
                    team_name=Valmoi
                    gold=150
                [/modify_side]
                [message]
                    id=Vleader
                    message= _ "It seems as though the tide has turned. Kromire, prepare to suffer for your arrogance!"
                [/message]
                [capture_village]
                    side=6
                    x,y=25,20
                [/capture_village]
                [capture_village]
                    side=6
                    x,y=31,13
                [/capture_village]
                [capture_village]
                    side=6
                    x,y=33,17
                [/capture_village]
                [capture_village]
                    side=6
                    x,y=35,16
                [/capture_village]
                [capture_village]
                    side=6
                    x,y=38,17
                [/capture_village]
                [capture_village]
                    side=6
                    x,y=40,18
                [/capture_village]
                [capture_village]
                    side=6
                    x,y=42,19
                [/capture_village]
                [capture_village]
                    side=6
                    x,y=42,21
                [/capture_village]
                [capture_village]
                    side=6
                    x,y=41,23
                [/capture_village]
                [capture_village]
                    side=6
                    x,y=39,24
                [/capture_village]
                [capture_village]
                    side=6
                    x,y=37,26
                [/capture_village]
                [capture_village]
                    side=6
                    x,y=34,25
                [/capture_village]
                [capture_village]
                    side=6
                    x,y=31,24
                [/capture_village]
                [capture_village]
                    side=6
                    x,y=30,21
                [/capture_village]
                [capture_village]
                    side=6
                    x,y=30,19
                [/capture_village]
                [capture_village]
                    side=6
                    x,y=22,29
                [/capture_village]
                [capture_village]
                    side=6
                    x,y=27,30
                [/capture_village]
                [capture_village]
                    side=6
                    x,y=27,33
                [/capture_village]
                [capture_village]
                    side=6
                    x,y=22,34
                [/capture_village]
                [capture_village]
                    side=6
                    x,y=28,34
                [/capture_village]
            [/else]
        [/if]
    [/event]
    [event]
        name=die
        [filter]
            id=Wleader2
        [/filter]
        [if]
            [have_unit]
                id=Eleader
            [/have_unit]
            [then]
            [/then]
            [else]
                [modify_side]
                    side=6
                    team_name=Valemoi
                    gold=150
                [/modify_side]
                [message]
                    id=Vleader
                    message= _ "It seems as though the tide has turned. Kromire, prepare to suffer for your arrogance!"
                [/message]
                [capture_village]
                    side=6
                    x,y=25,20
                [/capture_village]
                [capture_village]
                    side=6
                    x,y=31,13
                [/capture_village]
                [capture_village]
                    side=6
                    x,y=33,17
                [/capture_village]
                [capture_village]
                    side=6
                    x,y=35,16
                [/capture_village]
                [capture_village]
                    side=6
                    x,y=38,17
                [/capture_village]
                [capture_village]
                    side=6
                    x,y=40,18
                [/capture_village]
                [capture_village]
                    side=6
                    x,y=42,19
                [/capture_village]
                [capture_village]
                    side=6
                    x,y=42,21
                [/capture_village]
                [capture_village]
                    side=6
                    x,y=41,23
                [/capture_village]
                [capture_village]
                    side=6
                    x,y=39,24
                [/capture_village]
                [capture_village]
                    side=6
                    x,y=37,26
                [/capture_village]
                [capture_village]
                    side=6
                    x,y=34,25
                [/capture_village]
                [capture_village]
                    side=6
                    x,y=31,24
                [/capture_village]
                [capture_village]
                    side=6
                    x,y=30,21
                [/capture_village]
                [capture_village]
                    side=6
                    x,y=30,19
                [/capture_village]
                [capture_village]
                    side=6
                    x,y=22,29
                [/capture_village]
                [capture_village]
                    side=6
                    x,y=27,30
                [/capture_village]
                [capture_village]
                    side=6
                    x,y=27,33
                [/capture_village]
                [capture_village]
                    side=6
                    x,y=22,34
                [/capture_village]
                [capture_village]
                    side=6
                    x,y=28,34
                [/capture_village]
            [/else]
        [/if]
    [/event]

    [event]
        name=attack
        [filter]
            side=1
        [/filter]
        [filter_second]
            id=Vleader
        [/filter_second]
        [message]
            id=Vleader
            message= _ "No!"
        [/message]
        [message]
            id=Kromire
            message= _ "His help may be useful in the future, but can I really trust someone who will so easily betray me. Is his proposed aid in my conquest worth letting him live?"
            [option]
                message= _ "No mercy"
                [command]
                    [set_variable]
                        name=valemoi
                        value=1
                    [/set_variable]
                [/command]
            [/option]
            [option]
                message= _ "Let him live"
            [/option]
        [/message]
        [if]
            [variable]
                name=valemoi
                equals=1
            [/variable]
            [then]
                [message]
                    id=Kromire
                    message= _ "You should not have betrayed me."
                [/message]
            [/then]
            [else]
                [message]
                    id=Kromire
                    message= _ "I am not going to kill you just yet. There is still a battle to be won. Surrender your men to me, and let us drive out these intruders."
                [/message]
                [message]
                    id=Vleader
                    message= _ "We surrender, and will only bear swords against your foes."
                [/message]
                [modify_side]
                    side=6
                    team_name=Kromire
                [/modify_side]
            [/else]
        [/if]
    [/event]

    [event]
        name=enemies defeated
        [if]
            [variable]
                name=valemoi
                equals=1
            [/variable]
            [then]
                [message]
                    id=Kromire
                    message= _ "Pity that Valemoi could not have been more useful. His line is dead, his house ended. Harvest his serfs, I will turn some of them for the army, and the rest shall be for feeding. Gather your strength my children, we are heading back to Kromire Castle soon."
                [/message]
            [/then]
            [else]
                [message]
                    id=Kromire
                    message= _ "Valemoi, though you betrayed me, I have seen fit to give you a chance to live. Serve me or die."
                [/message]
                [message]
                    id=Vleader
                    message= _ "My forces are decimated, my lands torn apart. If I follow you, there will be nothing left to come back to, as my enemies will return again. Surely I can offer you something, some favor, so that you may leave me be."
                [/message]
                [message]
                    id=Kromire
                    message= _ "I do not know Valemoi, why don't you tell me? After all, you are the one with an interest in the result. I can as easily kill you now as take you with me."
                [/message]
                [message]
                    id=Vleader
                    message= _ ".... I could teach your blood mages how to use their powers to animate stone, I could also construct abominations that would serve well in your army."
                [/message]
                [message]
                    id=Kromire
                    message= _ "Fine. In addition you must provide my men with nourishment, and lodging until we are ready to leave. I will spare your life for now, Valemoi, but do not forget that you live at my mercy."
                [/message]
                [message]
                    id=Vleader
                    message= _ "So be it."
                [/message]
            [/else]
        [/if]
        [endlevel]
            result=victory
        [/endlevel]
    [/event]
[/scenario]
